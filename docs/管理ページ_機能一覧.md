# 管理ページ 機能一覧（動作確認済みリスト）

以下は `admin-site` の各画面（日本語名）と、実装済みの主な機能および動作確認ステータスの一覧です。

- **ダッシュボード（管理トップ）**:
  - 概要表示（未実装/軽量）: 表示はルーティング済み。動作に依存するコンポーネントは限定的。

- **設定（プロフィール / サイト設定）**:
  - プロフィール画像アップロード（ImageUpload 経由、R2 へ保存→`/api/images/complete`でDB保存）: 動作確認済み
  - 表示名 / 自己紹介 / メールの編集と保存（`PUT /api/admin/settings`）: 動作確認済み
  - ヘッダー画像の追加・並び替え・削除（キー配列で管理、即時サーバ保存）: 動作確認済み
  - ローディングアニメーション（GIF）アップロード・保存・クリア（`/api/site-settings` 経由）: 動作確認済み
  - SNSリンクの追加・検証（形式チェックとHEAD確認）: クライアント側ロジック動作済み（HEAD リクエストはCORSで制限されるため環境依存）

- **サイト設定（site-settings）**:
  - key/value ストアとしての読み書き（`/api/site-settings` / `PUT /api/admin/settings` 経由で永続化）: 動作確認済み

- **商品一覧（商品管理）**:
  - 一覧取得、公開状態の切替、下書き保存（`/api/admin/products` 関連）: フロントと API の呼び出しは連携済み、基本操作は動作確認済み
  - 新規作成ページの自動保存ドラフト（ローカルキャッシュ + API アップサート）: 動作確認済み

- **レシピ管理**:
  - レシピ一覧・編集・ピンの管理（`/api/recipes`）: 動作確認済み

- **コレクション管理**:
  - コレクション一覧・アイテム管理（`/collections`）: 動作確認済み（認証要）

- **タグ / タググループ管理**:
  - タグ / グループの一覧・編集（`/tags`, `/tag-groups`）: 動作確認済み（管理 API は認証必須）

- **ユーザー一覧（管理用 users ページ）**:
  - ユーザーの一覧表示と検索（`/admin/users`）: 実装済み。権限により表示範囲が制限される場合あり。

- **Amazon 関連管理**:
  - Amazon 認証情報の保存 API（機密はサーバ側で処理）: クライアント画面から送信可能、サーバ側保存は動作確認済み
  - Amazon セールスケジュール一覧/操作: 実装済み

- **認証 / ログイン / セッション**:
  - Supabase Auth（Cookie / Bearer）を使ったログイン、`whoami`/`session` API: 動作確認済み
  - 管理 UI 側は `apiFetch` を使い `X-User-Id` と `Authorization` を付与して public-worker に渡す設計（修正済）

備考:
- 画像アップロードフローは「キーのみ保存」ポリシーを守るため、R2 に保存 → `key` をクライアントに返す → `POST /api/images/complete` で DB にメタ保存 という2段階になっています。
- 管理系 API は `X-User-Id` をヘッダで受け取りつつ、受け取った場合は必ず JWT のユーザー ID と一致することを要求します（トークン検証は public-worker が Supabase に対して行います）。
- 一部の外部 HEAD チェック（SNS 検証など）はブラウザの CORS/`no-cors` に影響され、偽陽性/偽陰性が発生することがあります。環境ごとの挙動に注意してください。

---

このドキュメントは初期版です。詳細なスクリーンショットやネットワークログ、未対応のエッジケースを追加で記載できます。どのページを優先して E2E テスト（手動/自動）したいか教えてください。